// Modern News Ticker v2.2 | Copyright (c) CreativeTier | contact@CreativeTier.com
!function(Q){"use strict";var i={effect:"scroll",linksEnabled:!0,pauseOnHover:!0,autoplay:!0,feedType:"none",feedCount:5,linkTarget:"_blank",refresh:"10:00"},n={scroll:{scrollType:"continuous",scrollStart:"inside",scrollInterval:20,transitionTime:500},fade:{displayTime:4e3,transitionTime:300},type:{typeInterval:10,displayTime:4e3,transitionTime:300},slide:{slideDistance:100,displayTime:4e3,transitionTime:350}},a={rss:{feedUrl:"",loadType:"direct",loadProcess:"rss2json",forceNoCache:!1,rssLoadFile:"modern-ticker/php/load-rss.php"},json:{feedUrl:"",forceNoCache:!1,jsonLoadFile:"modern-ticker/php/load-json.php"},twitter:{twitterName:"",twitterLoadFile:"modern-ticker/php/load-twitter.php"}},A="Error",H="RSS load file not found.",J="JSON load file not found.",R="Twitter load file not found.",z="File not found.",Y="Empty response.",B="No message returned. See the browser console.",t={init:function(e){var t,q={};return e.feedType&&(e.feedType=e.feedType.toLowerCase()),"rss-atom"===e.feedType&&(e.feedType="rss"),e.twitterLoadingFile&&(e.twitterLoadFile=e.twitterLoadingFile),e.processService&&(e.loadProcess=e.processService),"YQL"===e.loadProcess&&(e.loadProcess="rss2json"),t=e.effect?e.effect:i.effect,Q.extend(q,n[t]),t=e.feedType?e.feedType:i.feedType,Q.extend(q,a[t]),Q.extend(q,i,e),this.each(function(){var a,s,e,t,i=!1,n=!1,r=!1,o=!1,c=!0,l=!1,d=Q(this),f=d.children(".mt-body"),p=f.children(".mt-label"),m=f.children(".mt-news"),u=m.children("ul"),h=u.children("li"),y=f.children(".mt-controls"),T=y.children(".mt-prev"),g=y.children(".mt-next"),v=y.children(".mt-play");if("scroll"==q.effect&&d.addClass("mt-scroll"),p.length&&m.css("left",Math.round(p.outerWidth(!0))),C(),m.css("height",Math.round(d.height()-2*parseInt(f.css("margin-top")))),Q(window).resize(C),"discontinuous"==q.scrollType){var k=[],w=0;u.children().each(function(){k.push(w),w+=Q(this).outerWidth()})}function C(){var e=f.width();p.length&&(e-=p.outerWidth(!0)),y.length&&(e-=y.outerWidth(!0)),e=Math.round(e),m.css("width",e),s=e}function b(){if(G(),u.addClass("mt-hide"),m.addClass("mt-preloader"),u.children().remove(),u.css("margin-left",0),h.css("opacity","1").removeClass("mt-hide"),u.append(h),"rss"===q.feedType||"json"===q.feedType){var e=q.feedUrl;q.forceNoCache&&(-1===e.indexOf("?")?e+="?":e+="&",e+=Math.random().toString())}switch(q.feedType){case"rss":"process"===q.loadType?("rss2json"!==q.loadProcess&&(e=encodeURIComponent(e)),"rss2json"===q.loadProcess?Q.ajax({url:"https://api.rss2json.com/v1/api.json",type:"GET",data:{rss_url:e},dataType:"json",success:function(e,t,i){"ok"===e.status?(j(e.items),E()):F(e.message,"rss2json")},error:function(e,t,i){x(i,z)}}):Q.ajax({url:q.rssLoadFile,type:"GET",data:{url:e},dataType:"json",success:function(e,t,i){e?(j(e.channel.item),E()):F(Y)},error:function(e,t,i){x(i,H)}})):Q.ajax({url:e,type:"GET",dataType:"xml",success:function(e,t,i){e?(j(Q(e).find("item"),"xml"),E()):F(Y)},error:function(e,t,i){x(i,z)}});break;case"json":"process"===q.loadType?Q.ajax({url:q.jsonLoadFile,type:"GET",data:{url:e},dataType:"json",success:function(e,t,i){e?(j(e.items),E()):F(Y)},error:function(e,t,i){x(i,J)}}):Q.ajax({url:q.feedUrl,type:"GET",dataType:"json",success:function(e,t,i){"ok"===e.status?(j(e.items),E()):F(e.message)},error:function(e,t,i){x(i,z)}});break;case"twitter":Q.ajax({url:q.twitterLoadFile,type:"GET",data:{name:q.twitterName,count:q.feedCount},success:function(e,t,i){e?(e=Q.parseJSON(e)).errors?F(e.errors[0].message,"Twitter"):(j(e,"twitter"),E()):F(Y)},error:function(e,t,i){x(i,R)}})}}function j(e,t){var i,n,a;if(n=0===q.feedCount||e.length<=q.feedCount?e.length:q.feedCount,"xml"===t)for(i=0;i<n;i++)a="<li>",q.linksEnabled?(a+='<a href="'+e.eq(i).children("link").text()+'" target="'+q.linkTarget+'">',a+=e.eq(i).children("title").text(),a+="</a>"):a+="<a>"+e.eq(i).children("title").text()+"</a>",a+="</li>",u.append(a);else if("twitter"===t)for(i=0;i<n;i++)a="<li>",q.linksEnabled?(a+='<a href="http://twitter.com/#!/'+e[i].user.id_str+"/status/"+e[i].id_str+'" target="'+q.linkTarget+'">',a+=e[i].text,a+="</a>"):a+="<a>"+e[i].text+"</a>",a+="</li>",u.append(a);else for(i=0;i<n;i++)a="<li>",q.linksEnabled?(a+='<a href="'+e[i].link+'" target="'+q.linkTarget+'">',a+=e[i].title,a+="</a>"):a+="<a>"+e[i].title+"</a>",a+="</li>",u.append(a)}function x(e,t){F("Not Found"===e?t:e)}function F(e,t){var i;m.removeClass("mt-preloader"),i=t||A,e||(e=B);var n='<p class="mt-error">'+(i+=": ")+e+"</p>";m.append(n)}function E(){m.removeClass("mt-preloader"),u.removeClass("mt-hide"),L()}function I(){"rss"!==q.feedType&&"json"!==q.feedType&&"twitter"!==q.feedType||(clearTimeout(t),l=!1,b())}function L(){a=0,u.children().each(function(){a+=Q(this).outerWidth(!0)+1}),u.css("width",a),"scroll"!=q.effect&&u.children("li:not(:first)").addClass("mt-hide"),c?(c=!1,q.autoplay&&(W(),y.length&&U())):P(),N("first"),q.refresh&&(t=setTimeout(I,function(e){var t;if("number"==typeof e)t=e;else{var i=e.split(":");i.reverse(),t=parseFloat(i[0]),i[1]&&(t+=60*parseFloat(i[1])),i[2]&&(t+=3600*parseFloat(i[2]))}return 1e3*t}(q.refresh))),l=!0}function S(e){l&&N(e.data.type)}function N(e){var t,i,n;if(!r)switch(r=!0,G(),e){case"first":switch(q.effect){case"scroll":"outside"==q.scrollStart&&u.css("margin-left",s),P();break;case"fade":u.children(":first").css({opacity:0}).animate({opacity:1},q.transitionTime,function(){P()});break;case"type":O(u.children(":first").css({opacity:0}).animate({opacity:1},q.transitionTime).children("a"));break;case"slide":u.children(":first").css({opacity:0,"margin-left":q.slideDistance}).animate({opacity:1,"margin-left":0},q.transitionTime,function(){P()})}r=!1;break;case"prev":switch(q.effect){case"scroll":"discontinuous"==q.scrollType?(t=M(),i=k.length-1,-1===t||0===t?u.animate({"margin-left":s},q.transitionTime,function(){u.css("margin-left",-a),u.animate({"margin-left":-k[i]},q.transitionTime,function(){r=!1})}):(n=-k[t-1],u.animate({"margin-left":n},q.transitionTime,function(){r=!1}))):(u.css({"margin-left":-Q(u.children(":last")).outerWidth()}).children(":last").prependTo(u),u.animate({"margin-left":0},q.transitionTime,function(){r=!1})),y.length&&T.mouseleave(function(){P()});break;case"fade":u.children(":first").animate({opacity:0},q.transitionTime,function(){Q(this).addClass("mt-hide"),u.children(":last").prependTo(u).removeClass("mt-hide").css({opacity:0}).animate({opacity:1},q.transitionTime,function(){P()}),r=!1});break;case"type":u.children(":first").animate({opacity:0},q.transitionTime,function(){Q(this).addClass("mt-hide"),O(u.children(":last").prependTo(u).removeClass("mt-hide").css({opacity:0}).animate({opacity:1},q.transitionTime).children("a")),r=!1});break;case"slide":u.children(":first").animate({opacity:0},q.transitionTime,function(){Q(this).addClass("mt-hide"),u.children(":last").prependTo(u).removeClass("mt-hide").css({opacity:0,"margin-left":q.slideDistance}).animate({opacity:1,"margin-left":0},q.transitionTime,function(){P()}),r=!1})}break;case"next":switch(q.effect){case"scroll":"discontinuous"==q.scrollType?(t=M())==(i=k.length-1)?u.animate({"margin-left":-a},q.transitionTime,function(){u.css("margin-left",s),u.animate({"margin-left":0},q.transitionTime,function(){r=!1})}):(n=-1==t?0:-k[t+1],u.animate({"margin-left":n},q.transitionTime,function(){r=!1})):u.animate({"margin-left":-Q(u.children(":first")).outerWidth()},q.transitionTime,function(){u.css("margin-left",0).children(":first").appendTo(u),r=!1}),y.length&&g.mouseleave(function(){P()});break;case"fade":u.children(":first").animate({opacity:0},q.transitionTime,function(){Q(this).addClass("mt-hide").appendTo(u),u.children(":first").removeClass("mt-hide").css({opacity:0}).animate({opacity:1},q.transitionTime,function(){P()}),r=!1});break;case"type":u.children(":first").animate({opacity:0},q.transitionTime,function(){Q(this).addClass("mt-hide").appendTo(u),O(u.children(":first").removeClass("mt-hide").css({opacity:0}).animate({opacity:1},q.transitionTime).children("a")),r=!1});break;case"slide":u.children(":first").animate({opacity:0},q.transitionTime,function(){Q(this).addClass("mt-hide").appendTo(u),u.children(":first").removeClass("mt-hide").css({opacity:0,"margin-left":q.slideDistance}).animate({opacity:1,"margin-left":0},q.transitionTime,function(){P()}),r=!1})}}}function M(){var e=parseFloat(u.css("margin-left")),t=k.length;if(0<e)return-1;e=Math.abs(e);for(var i=0;i<t-1;i++)if(e>=k[i]&&e<k[i+1])return i;return t-1}function W(){i=!0,e="scroll"==q.effect?setInterval(function(){if(!r){var e=parseFloat(u.css("margin-left"));u.css("margin-left",e-1),"discontinuous"==q.scrollType?e<0&&Math.abs(e)>a&&u.css("margin-left",s):e<0&&Math.abs(e)>Q(u.children("li")[0]).outerWidth()&&u.css("margin-left",0).children(":first").appendTo(u)}},q.scrollInterval):setInterval(function(){N("next")},q.displayTime)}function _(){i=!1,clearInterval(e)}function G(){i&&(n=!0,_())}function P(){n&&!o&&(W(),n=!1)}function O(s){var e,t;(t=(e=s).data("mt-type"))&&t.typing&&(clearInterval(t.interval),e.html(t.content),e.data("mt-type").typing=!1);var i=s.html(),r=i.split(""),o="_",c=0;s.html(o);var l=setInterval(function(){for(var e,t=!0,i="",n=!1,a=0;t;)i+=e=r[c++],"<"===e&&(n=!0),">"===e&&(n=!1),n||">"===e||a++,(a||c===r.length)&&(t=!1);o=o.split("_")[0]+i,c!==r.length&&(o+="_"),s.html(o),c===r.length&&(clearInterval(l),P())},q.typeInterval);s.data("mt-type",{typing:!0,content:i,interval:l})}function U(){v.addClass("mt-pause")}function D(){return!1}q.linksEnabled||u.find("a").removeAttr("href target"),q.pauseOnHover&&m.hover(function(){l&&(G(),o=!0)},function(){l&&(o=!1,P())}),y.length&&(T.mousedown(D).bind("click",{type:"prev"},S),g.mousedown(D).bind("click",{type:"next"},S),v.mousedown(D).click(function(){l&&(i?(_(),v.removeClass("mt-pause")):(W(),U()))})),"rss"===q.feedType||"json"===q.feedType||"twitter"===q.feedType?b():L(),d.data("pause",G),d.data("resume",P),d.data("refresh",I)})},pause:function(){return this.each(function(){Q(this).data("pause")()})},resume:function(){return this.each(function(){Q(this).data("resume")()})},refresh:function(){return this.each(function(){Q(this).data("refresh")()})}};Q.fn.modernTicker=function(e){return t[e]?t[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void Q.error("Method "+e+" does not exist on jQuery.modernTicker"):t.init.apply(this,arguments)}}(jQuery);